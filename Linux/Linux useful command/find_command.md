# FIND COMMAND IN LINUX

Find là một lệnh quan trọng và thường xuyên được sử dụng trong Linux. Lệnh *find* được dùng để tìm kiếm vị trí của file và thư mục có trong hệ thống.

Trong bài này ta chia thành các phần:
1. Lệnh find để tìm kiếm tệp với tên đã cho.
2. Tìm tệp dựa trên quyền .
3. Tìm tệp dựa trên chủ sở hữu và group.
4. Tìm tệp và thư mục theo ngày và thời gian.
5. Tìm tệp theo kích thước.

## Phần 1: Tìm kiếm tệp theo tên đã cho

- `find` sẽ hiển thị tên đường dẫn của tất cả các thư mục và thư mục con.

`find . -print`
`find -print`
`find .`

Dấu "." được dùng để chỉ thư mục hiện tại đang làm việc.

- `find` với tên
`find / -name foo`

Dấu "/" để chỉ thư mục root hay có nghĩa là tìm file trong toàn bộ hệ thống.

- Tìm tệp với tất cả trường hợp 
`find -name "downloads"`

<img src="../../image/Screenshot_1.png">

- Tìm kiếm find trong thư mục chỉ định
`find /etc -name "*.txt*"`

Lệnh này sẽ tìm tất cả các file có phần mở rộng ".txt" trong thư mục /etc

- Tìm file không có tên trùng với tên tìm kiếm
`find -not -name "test.txt"`

- Tìm tệp trong thư mục hiện tại và một thư mục con của thư mục hiện tại
`find -maxdepth 2 -name "test.txt"`

- Tìm file  trong thư mục con giữa level 1 và 4
`find . -maxdepth 2 -maxdepth 5 -name "test.txt"`

- Tìm kiếm tệp với kiểu tệp 
`find . -type s`

"s" ở đây là file socket. Ngoài ra lệnh `find` còn hỗ trợ nhiều loại file khác.
<img src="../../image/Screenshot_2.png">

- Tìm file và xóa file đó
` find . -type f -name "test.txt" -exec rm -f {} \;`

## Phần 2: Tìm tệp theo quyền

- Tìm tất cả thư mục có quyền 777 và sử dụng chmod để set quyền 755
`find / -type d -perm 777 -print -exec chmod 755 {}\;`

- Tìm tất cả các file không có quyền 777
`find / -type f !perm 777`

- Tìm file có set suid để privilege escalation
`find / -type f –perm –u=s 2>/dev/null`

    * hoặc cũng có thể dùng số
        - SUID: 4*** (*** là các quyền bình thường)
        - GUID: 2***
        - Sticky Bit: 1***

## Phần 3: Tìm file dựa theo người sở hữu và nhóm

- Tìm find theo người sở hữu
`find /home -user kali`

- Tìm file dựa trên group
`find /home -group redteam`

## Phần 4: Tìm file theo ngày và thời gian

- Tìm find mới được chỉnh sửa trong vòng 30 phút
`find . --mmin 30`

- Tìm file chỉnh sửa trong vòng 1 ngày
`find --mtime 1`

- Tìm file được chỉnh sửa trong khoảng từ 10 đến 20 ngày trước
`find --mtime +10 --mtime -100`

Trong lệnh find có `ctime` cho changed file và `mtime` cho modified file. Change là thay đổi file hoàn toàn, modify là chỉ cải tiến chỉnh sửa file cho phù hợp.

- Tìm file đã được tạo trong khoảng thời gian của 2 file cho trước
`find . -cnewer f1 -and ! -cnewer f2`

## Phần 5: Tìm file dựa theo kích thước

- Tìm file có kích thước đúng bằng 102 bytes
`find / -size 102c`

- Tìm file có kích thước trong khoảng 50MB đến 100MB
`find / -size +50M -size -100M`

## Một số trick với lệnh find 

- Tìm kiếm lệnh find mới được khởi chạy gần đây nhất
`!find`

- Tìm file rỗng trong thư mục
`find . -maxdepth 1 -empty ./empty_file`

- Tìm file có kích thước nhỏ nhất 
`find . -type f -exec ls -s {} \; |sort -n |head -1`

- Tìm file ẩn
`find /tmp -type f -name ".*"`

- Xóa các file có đuôi .mp3 và kích thước lớn hơn 10MB
`find / -type f -name "*.mp3" -size +10M -exec rm {} \;`   
    - {}: lấy từng đầu ra của câu lệnh trước làm tham số cho câu lệnh sau
    - \; : giữ cho câu lệnh được chạy liên tục cho đến khi hoàn thành
